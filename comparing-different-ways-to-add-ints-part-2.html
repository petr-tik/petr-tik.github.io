<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="My blog, ">

        <link rel="alternate"  href="/feeds/all.atom.xml" type="application/atom+xml" title="My blog Full Atom Feed"/>

        <title>Comparing different ways to add ints (part 2) // My blog // </title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/pure.css">
    <link rel="stylesheet" href="/theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background: none repeat scroll 0% 0% #3D4F5D">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <h1 class="brand-main"><a href="">My blog</a></h1>
                            <p class="tagline"></p>
                                <p class="links"><a href="/pages/about">About</a></p>
                                <p class="social">
                                    <a href="https://github.com/petr-tik">
                                        <i class="fa fa-GitHub fa-3x"></i>
                                    </a>
                                    <a href="https://twitter.com/petr_tik">
                                        <i class="fa fa-Twitter fa-3x"></i>
                                    </a>
                                </p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Comparing different ways to add ints (part 2)</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="/tag/python.html">python</a>
                        </p>
                </header>
            </section>
            <h2>Background</h2>
<p>As outlined in part 1, we are comparing recursive and iterative solutions to a simple problem. As seen in the chart, there is a sudden jump in execution times of the recursive function, when the length of array becomes ~900 ints. Using the <code>cProfile</code> module in python, I will be investigating what caused this increase in execution times. </p>
<h3>Helper methods</h3>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">profile_run</span><span class="p">(</span><span class="n">r_limit</span><span class="p">,</span> <span class="n">l_limit</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">cProfile</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
    <span class="n">iter_arr_lengths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recur_arr_lengths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iter_times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recur_times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">arr_length</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_limit</span><span class="p">,</span> <span class="n">l_limit</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)]</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)]</span>

        <span class="c"># good test case, because there will be a carry bit over every step</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="n">res_iter</span><span class="p">,</span> <span class="n">time_iter</span> <span class="o">=</span> <span class="n">iter_sum</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">dump_stats</span><span class="p">(</span><span class="s">&quot;iter_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)))</span>
        <span class="n">iter_arr_lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)</span>
        <span class="n">iter_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_iter</span><span class="p">)</span>

        <span class="n">pr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="n">res_recur</span><span class="p">,</span> <span class="n">time_recur</span> <span class="o">=</span> <span class="n">recur_sum</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">dump_stats</span><span class="p">(</span><span class="s">&quot;recur_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)))</span>
        <span class="n">recur_arr_lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr_length</span><span class="p">)</span>
        <span class="n">recur_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_recur</span><span class="p">)</span>

    <span class="n">plot_results_for_cprofile</span><span class="p">([</span><span class="n">iter_arr_lengths</span><span class="p">,</span> <span class="n">recur_arr_lengths</span><span class="p">],</span>
                              <span class="p">[</span><span class="n">iter_times</span><span class="p">,</span> <span class="n">recur_times</span><span class="p">],</span> <span class="n">r_limit</span><span class="p">,</span> <span class="n">l_limit</span><span class="p">)</span>
</pre></div>


<p>The <code>plot_results</code> method will also change. Instead of using a scatter plot, we will be drawing lines, which will make it easier to see the increase in gradient. It also takes the right and left limits to the x values (lengths of the array). Setting xlim to the plot will help us focus the picture. Small changes include not marking the last points in recursive times (we will avoid stack overflow). </p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">plot_results_for_cprofile</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">r_limit</span><span class="p">,</span> <span class="n">l_limit</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">r_limit</span><span class="p">,</span> <span class="n">l_limit</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Size of input arrays&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Time to calculate sum (ms)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Comparing iterative vs recursive sum methods&#39;</span><span class="p">)</span>

    <span class="n">iter_arr_lengths</span><span class="p">,</span> <span class="n">recur_arr_lengths</span> <span class="o">=</span> <span class="n">xs</span>
    <span class="n">iters</span><span class="p">,</span> <span class="n">recurs</span> <span class="o">=</span> <span class="n">ys</span>

    <span class="c"># plot iterative times</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">iter_arr_lengths</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">iters</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>

    <span class="c"># plot recursive times</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">recur_arr_lengths</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">recurs</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">)</span>
    <span class="c"># last point in recursive times is before stack overflow</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="s">&quot;sum_ints_plot.png&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Saved plot as {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
</pre></div>
            <a href="#" class="go-top">Go Top</a>
<footer class="footer">
    <p>&copy; Petr Tikilyaynen &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>

</body>
</html>